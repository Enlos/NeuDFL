import numpy as np
import matplotlib.pyplot as plt

# Cifar-10 0%MA
# all_w_data = np.array([[ 0.78, 0.87, 0.88, 0.7 , 1.12, 0.86, 0.83, 0.32, 0.78, 1.02, 0.82, 0.68,
#                           1.05, 1.1 , 1.22, 0.71, 0.66, 0.87, 0.92, 0.6 , 0.83, 0.63, 0.81, 0.87,
#                           1.06, 0.83, 0.73, 0.87, 0.63, 0.75, 0.71, 0.79, 0.75, 0.83, 0.76, 0.85,
#                           0.77, 0.9 , 0.68, 0.74, 0.7 , 0.76, 0.65, 0.46, 0.88, 0.84, 0.65, 0.85,
#                           0.69, 0.68, 0.53, 0.69, 0.82, 0.69, 0.64, 0.62, 0.5 , 0.57, 0.69, 0.68,
#                           0.79, 0.66, 0.47, 0.9 , 0.65, 0.61, 0.59, 0.85, 0.86, 0.56, 0.46, 0.65,
#                           0.63, 0.63, 0.68, 0.49, 0.64, 0.55, 0.33, 0.51, 0.25, 0.49, 0.47, 0.61,
#                           0.59, 0.64, 0.78, 0.86, 0.48, 0.78, 0.66, 0.8 , 0.58, 0.88, 0.42, 0.95,
#                           0.55, 0.76, 0.62, 0.83],
#                         [ 0.12, 0.47, 0.06,-0.14, 0.15, 0.3 , 0.08,-0.26,-0.37,-0.25,-0.45,-0.72,
#                           -0.58,-0.58,-0.36,-0.42,-0.31,-0.52,-0.37,-0.7 ,-0.32,-0.66,-0.43,-0.35,
#                           -0.43,-0.28,-0.46,-0.63,-0.13,-0.47,-0.11,-0.58,-0.3 ,-0.47,-0.28,-0.65,
#                           -0.26,-0.58,-0.08,-0.34,-0.24,-0.38,-0.36,-0.64,-0.36,-0.43,-0.34,-0.2 ,
#                           -0.23,-0.34,-0.13,-0.56,-0.15,-0.36,-0.32,-0.42,-0.46,-0.22,-0.16,-0.53,
#                           -0.5 ,-0.59,-0.16,-0.5 ,-0.28,-0.57,-0.29,-0.59,-0.2 ,-0.74,-0.28,-0.86,
#                           -0.29,-0.68,-0.43,-0.89,-0.35,-0.58,-0.11,-0.67,-0.05,-0.48,-0.14,-0.67,
#                           -0.11,-0.64,-0.19,-0.81,-0.16,-0.8 ,-0.28,-0.75,-0.34,-0.66,-0.16,-0.79,
#                           -0.27,-0.73,-0.37,-0.75],
#                         [ 0.86, 0.91, 1.26, 0.63, 1.18, 1.01, 1.63, 1.59, 1.49, 1.25, 1.56, 1.74,
#                           1.46, 1.52, 1.13, 1.58, 1.62, 1.54, 1.44, 2.02, 1.39, 1.52, 1.46, 1.29,
#                           1.7 , 1.6 , 1.24, 1.55, 1.7 , 1.81, 1.6 , 1.71, 1.26, 1.67, 1.53, 1.58,
#                           1.66, 1.75, 1.52, 1.73, 1.61, 1.6 , 1.35, 1.91, 1.51, 1.83, 1.61, 1.45,
#                           1.58, 1.53, 1.53, 1.7 , 1.51, 1.64, 1.33, 1.5 , 1.55, 1.77, 1.53, 1.46,
#                           1.29, 1.47, 1.49, 1.8 , 1.54, 1.56, 1.43, 1.6 , 1.27, 1.6 , 1.44, 1.86,
#                           1.46, 1.78, 1.17, 1.25, 1.24, 1.27, 1.49, 1.25, 1.23, 1.45, 1.1 , 1.38,
#                           1.  , 1.3 , 0.94, 1.3 , 1.13, 1.28, 1.1 , 1.19, 1.12, 1.19, 0.88, 1.21,
#                           1.1 , 1.06, 0.82, 1.18],
#                         [ 0.38, 0.61, 0.35, 1.2 , 0.45, 0.75, 0.51, 0.98, 1.26, 1.46, 1.11, 1.49,
#                           1.25, 0.95, 1.34, 1.32, 1.07, 1.41, 0.86, 0.97, 0.8 , 1.23, 1.02, 1.14,
#                           0.78, 0.89, 0.7 , 0.84, 0.74, 0.9 , 0.74, 0.76, 0.89, 0.81, 1.04, 0.62,
#                           0.68, 0.7 , 0.84, 0.74, 0.71, 0.38, 0.7 , 0.48, 0.88, 0.52, 0.71, 0.71,
#                           0.63, 0.59, 0.55, 0.55, 0.29, 0.48, 0.59, 0.69, 0.32, 0.49, 0.41, 0.44,
#                           0.41, 0.58, 0.4 , 0.44, 0.37, 0.56, 0.37, 0.37, 0.23,-0.05, 0.77, 0.25,
#                           0.51, 0.1 , 0.49, 0.69, 0.75, 0.61, 0.68, 0.47, 0.69, 0.3 , 0.7 , 0.35,
#                           0.43, 0.3 , 0.73, 0.37, 0.39, 0.39, 0.76, 0.5 , 0.76, 0.25, 0.56, 0.35,
#                           0.66, 0.36, 0.83, 0.08],
#                         [ 0.74, 0.81, 0.8 , 0.91, 0.97, 0.98, 0.97, 0.66, 1.23, 0.59, 0.97, 1.04,
#                           1.04, 0.84, 0.6 , 0.9 , 0.83, 0.88, 0.75, 0.76, 0.94, 0.94, 0.68, 0.82,
#                           0.41, 0.72, 0.77, 0.57, 0.92, 0.75, 0.8 , 0.68, 0.88, 0.62, 0.54, 0.93,
#                           0.66, 0.81, 0.83, 0.64, 0.74, 1.  , 0.59, 0.83, 0.72, 0.82, 0.62, 0.8 ,
#                           0.33, 0.94, 0.68, 0.98, 0.64, 0.94, 0.76, 0.79, 0.64, 0.88, 0.68, 1.02,
#                           0.73, 1.14, 0.66, 0.7 , 0.71, 0.95, 0.92, 0.7 , 0.63, 0.9 , 0.55, 0.85,
#                           0.48, 0.63, 0.67, 0.61, 0.5 , 0.42, 0.71, 0.7 , 0.46, 0.88, 0.55, 0.8 ,
#                           0.51, 0.95, 0.48, 0.66, 0.64, 0.56, 0.51, 0.55, 0.5 , 0.47, 0.71, 0.48,
#                           0.5 , 0.51, 0.29, 0.62],
#                         [ 0.14,-0.26,-0.13, 0.02, 0.13,-0.09,-0.05, 0.2 ,-0.11,-0.  , 0.12, 0.12,
#                           -0.01, 0.35, 0.47, 0.49, 0.49, 0.14, 0.57, 0.68, 0.35, 0.48, 0.5 , 0.4 ,
#                           0.4 , 0.87, 0.78, 0.77, 0.5 , 0.26, 0.5 , 0.23, 0.6 , 0.5 , 0.48, 0.74,
#                           0.54, 0.38, 0.37, 0.56, 0.34, 0.44, 0.52, 0.52, 0.22, 0.63, 0.27, 0.21,
#                           0.35, 0.46, 0.32, 0.24, 0.41, 0.15, 0.21, 0.32, 0.25, 0.42, 0.37, 0.5 ,
#                           0.47, 0.32, 0.36, 0.29, 0.33, 0.2 , 0.24, 0.28,-0.27, 0.39, 0.31, 0.24,
#                           0.26, 0.22, 0.15, 0.51,-0.08, 0.47,-0.09, 0.43,-0.13, 0.26, 0.12, 0.16,
#                           0.27, 0.39, 0.13, 0.42, 0.36, 0.35, 0.04, 0.26,-0.1 , 0.35, 0.13, 0.17,
#                           0.09, 0.16, 0.07, 0.4 ],
#                         [-0.61,-0.14,-0.48,-0.6 ,-0.73,-0.47,-0.41,-0.29,-0.05,-0.41,-0.23,-0.16,
#                          -0.43,-0.15,-0.5 ,-0.66,-0.45,-0.51,-0.26,-0.49,-0.25,-0.34,-0.02,-0.31,
#                          -0.3 ,-0.69,-0.26,-0.17,-0.45,-0.56,-0.5 ,-0.39,-0.39,-0.46,-0.26,-0.49,
#                          -0.29,-0.62,-0.51,-0.51,-0.46,-0.48,-0.32,-0.36,-0.46,-0.6 ,-0.34,-0.5 ,
#                          -0.35,-0.69,-0.55,-0.68,-0.74,-0.43,-0.7 ,-0.6 ,-0.43,-0.81,-0.53,-0.67,
#                          -0.77,-0.68,-0.5 ,-0.72,-0.66,-0.51,-0.58,-0.66,-0.39,-0.71,-0.52,-0.65,
#                          -0.62,-0.47,-0.49,-0.87,-0.55,-0.81,-0.71,-0.66,-0.5 ,-0.78,-0.63,-0.69,
#                          -0.67,-0.84,-0.78,-0.77,-0.97,-0.98,-0.89,-1.  ,-0.83,-0.71,-0.86,-0.71,
#                          -1.04,-0.64,-0.95,-0.89],
#                         [ 0.12,-0.43,-0.56,-0.57,-0.74,-0.48,-1.04,-0.67,-0.87,-0.72,-0.76,-0.93,
#                           -0.95,-0.57,-0.93,-0.8 ,-0.89,-1.03,-0.96,-0.86,-1.13,-0.92,-1.11,-1.14,
#                           -1.12,-0.93,-1.08,-1.15,-1.1 ,-1.11,-1.26,-1.1 ,-1.09,-1.  ,-1.32,-1.1 ,
#                           -1.27,-1.13,-1.23,-1.32,-1.23,-1.  ,-1.2 ,-1.06,-0.98,-1.22,-0.89,-1.11,
#                           -1.13,-1.05,-1.05,-1.07,-1.03,-0.88,-0.78,-0.87,-0.89,-0.99,-0.92,-1.11,
#                           -0.86,-1.03,-0.95,-0.91,-0.93,-0.98,-0.97,-0.8 ,-0.72,-0.68,-0.87,-0.87,
#                           -0.59,-0.47,-0.54,-0.67,-0.66,-0.46,-0.71,-0.57,-0.52,-0.55,-0.49,-0.5 ,
#                           -0.71,-0.5 ,-0.5 ,-0.49,-0.57,-0.29,-0.54,-0.31,-0.45,-0.39,-0.44,-0.47,
#                           -0.26,-0.32,-0.36,-0.36],
#                         [-0.22,-0.63,-0.18,-0.09,-0.06,-0.35,-0.34,-0.26,-0.8 ,-0.87,-1.08,-1.04,
#                          -0.73,-1.05,-1.16,-0.84,-1.06,-0.73,-0.99,-0.71,-0.78,-0.82,-0.96,-0.62,
#                          -0.82,-0.88,-0.72,-0.59,-0.95,-0.3 ,-0.58,-0.51,-0.69,-0.44,-0.69,-0.59,
#                          -0.71,-0.28,-0.49,-0.41,-0.29,-0.27,-0.34,-0.23,-0.67,-0.59,-0.51,-0.4 ,
#                          -0.35,-0.36,-0.24,-0.15,-0.29,-0.19,-0.16,-0.17,-0.13,-0.3 ,-0.34,-0.13,
#                          -0.18,-0.2 ,-0.18,-0.36,-0.27,-0.27,-0.12,-0.26, 0.11, 0.12,-0.25, 0.02,
#                          -0.2 ,-0.23,-0.2 , 0.21,-0.04, 0.12,-0.13, 0.02, 0.06,-0.14, 0.06, 0.13,
#                          0.17,-0.13,-0.09,-0.07, 0.06, 0.13,-0.01, 0.28, 0.11,-0.03, 0.11, 0.16,
#                          0.04, 0.17, 0.31, 0.14],
#                         [ 0.22, 0.32, 0.48, 0.44, 0.01,-0.04, 0.26, 0.17,-0.15, 0.36, 0.35, 0.17,
#                           0.26,-0.04, 0.52, 0.07, 0.36, 0.27, 0.32, 0.02, 0.42, 0.2 , 0.27, 0.14,
#                           0.55, 0.09, 0.48, 0.13, 0.3 , 0.12, 0.24, 0.55, 0.21, 0.04, 0.29, 0.2 ,
#                           0.31, 0.16, 0.11, 0.22, 0.15,-0.02, 0.42, 0.1 , 0.25, 0.19, 0.19, 0.16,
#                           0.41, 0.19, 0.28, 0.22, 0.44,-0.16, 0.31, 0.01, 0.51, 0.06, 0.11, 0.17,
#                           0.42, 0.15, 0.2 , 0.15, 0.31, 0.21, 0.16, 0.27, 0.21, 0.34, 0.11, 0.24,
#                           0.05, 0.18, 0.17, 0.36, 0.2 , 0.06, 0.19, 0.15, 0.13, 0.22,-0.14, 0.04,
#                           0.12, 0.13, 0.07, 0.12, 0.2 , 0.13, 0.18, 0.02, 0.18, 0.17, 0.13, 0.17,
#                           0.13, 0.17, 0.2 , 0.21]])

#Cifar-10_20#MA:
# all_w_data = np.array([[ 0.59, 0.87, 0.63, 0.78, 1.19, 1.05, 0.79, 1.36, 1.  , 0.52, 0.55, 1.19,
#                          0.76, 1.09, 0.5 , 0.82, 0.65, 1.13, 0.64, 0.68, 0.76, 0.73, 0.19, 0.8 ,
#                          0.83, 0.66, 0.48, 1.04, 0.31, 0.66, 0.27, 0.72, 0.24, 0.9 , 0.51, 0.78,
#                          0.41, 0.71, 0.4 , 0.69, 0.62, 0.71, 0.45, 0.6 , 0.63, 0.91, 0.29, 0.81,
#                          0.11, 0.73, 0.25, 0.66, 0.32, 0.81, 0.4 , 0.6 , 0.43, 0.52, 0.37, 0.62,
#                          0.36, 0.55, 0.3 , 0.49, 0.3 , 0.65, 0.41, 0.66, 0.36, 0.69, 0.18, 0.49,
#                          0.37, 0.65, 0.03, 0.46, 0.34, 0.54, 0.23, 0.63, 0.19, 0.6 , 0.11, 0.57,
#                          0.04, 0.43, 0.02, 0.37, 0.35, 0.59, 0.41, 0.65, 0.21, 0.5 , 0.33, 0.46,
#                          0.07, 0.54, 0.05, 0.49],
#                        [ 0.36, 0.75, 0.56, 0.06, 0.24, 0.09,-0.33,-0.18,-0.4 ,-0.03,-0.05,-0.21,
#                          -0.13,-0.38,-0.14,-0.19,-0.33,-0.55,-0.18,-0.02,-0.37,-0.55,-0.29,-0.63,
#                          -0.16,-0.36,-0.22,-0.44, 0.17,-0.4 ,-0.04,-0.37,-0.07,-0.05, 0.01,-0.2 ,
#                          -0.09,-0.21, 0.01,-0.02,-0.  ,-0.25, 0.15,-0.22, 0.02,-0.3 ,-0.16,-0.19,
#                          -0.01,-0.19,-0.27,-0.07,-0.08,-0.17,-0.01,-0.02,-0.01,-0.11,-0.12,-0.41,
#                          -0.11,-0.26,-0.17,-0.4 ,-0.02,-0.14,-0.1 ,-0.18,-0.24,-0.2 ,-0.36,-0.23,
#                          -0.31,-0.21,-0.22,-0.31,-0.44,-0.06,-0.15,-0.11,-0.04,-0.08,-0.06, 0.08,
#                          0.15,-0.23,-0.02,-0.06,-0.16,-0.21,-0.19,-0.29,-0.1 ,-0.19,-0.13,-0.22,
#                          -0.18,-0.13,-0.2 ,-0.15],
#                        [ 1.48, 0.67, 1.22, 1.07, 1.29, 0.93, 1.62, 1.4 , 1.69, 1.78, 1.59, 2.07,
#                          2.21, 2.  , 2.02, 2.44, 2.04, 2.48, 2.23, 2.48, 2.22, 2.62, 2.13, 2.54,
#                          2.22, 2.39, 2.28, 2.8 , 2.24, 2.45, 2.24, 2.5 , 2.37, 2.83, 2.29, 2.76,
#                          2.44, 2.69, 2.54, 2.61, 2.39, 2.73, 2.35, 2.9 , 2.38, 2.95, 2.5 , 2.86,
#                          2.12, 2.9 , 2.49, 2.97, 2.55, 2.72, 2.26, 2.72, 2.51, 2.76, 2.41, 2.61,
#                          2.54, 2.5 , 2.37, 2.77, 2.51, 2.5 , 2.55, 2.6 , 2.25, 2.61, 2.43, 2.67,
#                          2.24, 2.46, 2.55, 2.76, 2.11, 2.67, 2.44, 2.82, 2.43, 2.56, 2.27, 2.53,
#                          2.43, 2.65, 2.  , 2.39, 2.03, 2.42, 2.07, 2.47, 2.23, 2.23, 2.17, 2.55,
#                          1.79, 2.49, 2.39, 2.3 ],
#                        [ 0.76, 0.61, 0.47, 0.61, 1.21, 1.18, 1.18, 1.41, 1.17, 1.52, 1.76, 1.65,
#                          1.33, 1.25, 1.54, 1.53, 1.93, 1.42, 1.58, 1.37, 1.37, 1.46, 1.49, 1.37,
#                          1.57, 1.25, 1.53, 1.19, 1.48, 1.22, 1.5 , 0.94, 1.57, 1.06, 1.32, 1.03,
#                          1.49, 0.81, 1.15, 0.93, 1.07, 0.8 , 1.08, 1.05, 1.48, 0.76, 1.42, 0.73,
#                          1.46, 0.79, 1.3 , 0.84, 1.39, 0.8 , 1.42, 0.65, 1.42, 0.87, 1.22, 0.96,
#                          1.36, 1.1 , 1.26, 1.14, 1.34, 0.76, 1.4 , 0.71, 1.3 , 0.7 , 1.15, 0.86,
#                          1.32, 1.  , 1.42, 0.99, 1.29, 1.  , 1.14, 0.77, 1.14, 0.74, 1.06, 1.15,
#                          1.31, 1.11, 1.06, 0.98, 1.08, 0.93, 1.22, 0.71, 1.12, 0.86, 1.22, 1.1 ,
#                          1.1 , 0.8 , 1.26, 0.98],
#                        [ 0.67, 1.14, 0.99, 1.01, 0.8 , 0.91, 1.11, 0.84, 1.35, 1.38, 1.03, 1.01,
#                          0.78, 0.74, 0.68, 0.84, 0.58, 0.91, 0.8 , 0.74, 0.52, 0.78, 0.91, 0.84,
#                          0.59, 0.74, 0.46, 0.59, 0.58, 0.47, 0.36, 0.7 , 0.32, 0.4 , 0.5 , 0.39,
#                          0.44, 0.18, 0.5 , 0.31, 0.48, 0.21, 0.38, 0.35, 0.38, 0.41, 0.29, 0.39,
#                          0.45, 0.31, 0.34, 0.34, 0.51, 0.11, 0.33, 0.28, 0.44, 0.03, 0.27, 0.44,
#                          0.29, 0.62, 0.43, 0.25, 0.09, 0.23, 0.3 , 0.31, 0.33, 0.28, 0.18, 0.4 ,
#                          0.5 , 0.37, 0.1 , 0.18, 0.32, 0.19, 0.15, 0.31, 0.07, 0.23, 0.19,-0.04,
#                          0.36, 0.1 , 0.55, 0.03, 0.19,-0.04, 0.13, 0.05, 0.26, 0.04, 0.25, 0.08,
#                          0.25,-0.04, 0.12,-0.07],
#                        [ 0.36, 0.2 , 0.44, 0.57, 0.11, 0.07, 0.36, 0.08, 0.47, 0.3 , 0.9 , 0.41,
#                          0.7 , 0.4 , 0.81, 0.7 , 0.96, 0.38, 1.04, 0.81, 1.18, 0.63, 0.92, 0.66,
#                          1.12, 0.47, 0.65, 0.58, 1.27, 0.53, 0.76, 0.44, 0.94, 0.41, 0.92, 0.53,
#                          0.76, 0.62, 0.76, 0.51, 0.52, 0.6 , 0.79, 0.48, 0.54, 0.41, 0.66, 0.41,
#                          0.62, 0.36, 0.67, 0.26, 0.56, 0.38, 0.52, 0.39, 0.45, 0.42, 0.55, 0.36,
#                          0.27, 0.24, 0.62, 0.35, 0.4 , 0.4 , 0.14, 0.49, 0.59, 0.62, 0.35, 0.34,
#                          0.46, 0.25, 0.23, 0.4 , 0.54, 0.32, 0.43, 0.18, 0.32, 0.23, 0.25, 0.09,
#                          0.03, 0.16, 0.07, 0.24, 0.33, 0.27, 0.11, 0.31, 0.06, 0.3 ,-0.1 ,-0.13,
#                          0.23,-0.19,-0.02, 0.09],
#                        [-0.18,-0.18,-0.1 ,-0.04,-0.34,-0.4 ,-0.32,-0.12,-0.46,-0.23,-0.27,-0.24,
#                         0.14, 0.14,-0.06,-0.23,-0.53,-0.11,-0.56, 0.02, 0.06, 0.05, 0.12,-0.04,
#                         -0.27, 0.13, 0.36,-0.07,-0.24,-0.14, 0.08, 0.1 ,-0.36,-0.12,-0.02,-0.18,
#                         -0.09,-0.22, 0.02,-0.29,-0.04,-0.24,-0.01,-0.28,-0.12,-0.33,-0.34,-0.26,
#                         -0.14,-0.27,-0.14,-0.36,-0.3 ,-0.18,-0.2 ,-0.03,-0.09,-0.23,-0.24,-0.3 ,
#                         -0.12,-0.39,-0.42,-0.47,-0.04,-0.08,-0.32,-0.29,-0.19,-0.47,-0.02,-0.32,
#                         -0.21,-0.45,-0.15,-0.51, 0.06,-0.73,-0.08,-0.8 ,-0.2 ,-0.7 ,-0.15,-0.65,
#                         -0.29,-0.54,-0.07,-0.7 ,-0.09,-0.75,-0.01,-0.63,-0.16,-0.43,-0.26,-0.67,
#                         -0.2 ,-0.42,-0.18,-0.63],
#                        [-1.63,-2.29,-2.13,-1.79,-1.88,-1.99,-2.13,-2.1 ,-2.35,-2.2 ,-2.29,-2.4 ,
#                         -2.52,-2.2 ,-2.26,-2.5 ,-2.53,-2.7 ,-2.31,-2.82,-2.24,-2.71,-2.51,-2.52,
#                         -2.5 ,-2.43,-2.32,-2.6 ,-2.69,-2.38,-2.27,-2.56,-2.63,-2.62,-2.61,-2.56,
#                         -2.49,-2.34,-2.66,-2.55,-2.56,-2.5 ,-2.55,-2.65,-2.42,-2.57,-2.23,-2.6 ,
#                         -2.26,-2.49,-2.28,-2.48,-2.52,-2.5 ,-2.29,-2.54,-2.5 ,-2.42,-2.14,-2.48,
#                         -2.34,-2.48,-2.16,-2.41,-2.18,-2.18,-2.04,-2.28,-2.06,-2.13,-1.85,-2.33,
#                         -1.91,-2.15,-1.94,-2.19,-2.01,-1.96,-1.99,-1.91,-1.81,-1.86,-1.7 ,-2.02,
#                         -1.9 ,-1.93,-1.56,-1.61,-1.66,-1.66,-1.53,-1.62,-1.63,-1.61,-1.49,-1.57,
#                         -1.59,-1.48,-1.61,-1.46],
#                        [-0.32,-0.01,-0.01,-0.08, 0.01,-0.23,-0.16,-0.55,-0.59,-0.84,-0.95,-1.02,
#                         -0.83,-0.86,-1.01,-1.24,-0.87,-0.92,-1.04,-1.05,-1.23,-1.01,-0.78,-1.18,
#                         -1.12,-0.96,-1.07,-1.14,-0.9 ,-0.8 ,-0.72,-0.66,-0.38,-0.89,-0.54,-0.66,
#                         -0.8 ,-0.46,-0.73,-0.57,-0.58,-0.5 ,-0.56,-0.65,-0.68,-0.84,-0.64,-0.52,
#                         -0.51,-0.51,-0.33,-0.35,-0.34,-0.36,-0.34,-0.63,-0.7 ,-0.42,-0.33,-0.36,
#                         -0.45,-0.51,-0.27,-0.28,-0.36,-0.44,-0.48,-0.47,-0.38,-0.59,-0.37,-0.31,
#                         -0.55,-0.5 ,-0.21,-0.28,-0.28,-0.44,-0.43,-0.37,-0.25,-0.46,-0.18,-0.34,
#                         -0.19,-0.33,-0.19,-0.3 ,-0.19,-0.27,-0.41,-0.31,-0.16,-0.33,-0.32,-0.25,
#                         0.14,-0.43,-0.03,-0.3 ],
#                        [ 0.44, 0.77, 0.42, 0.32,-0.14, 0.86, 0.32, 0.31, 0.52, 0.23, 0.11,-0.07,
#                          -0.08, 0.19, 0.25, 0.17, 0.4 , 0.27, 0.09, 0.09,-0.01, 0.26, 0.04, 0.4 ,
#                          -0.07, 0.31, 0.04, 0.23,-0.05, 0.54,-0.05, 0.33, 0.1 , 0.19,-0.28, 0.22,
#                          -0.02, 0.3 , 0.04, 0.42, 0.13, 0.46,-0.08, 0.42,-0.23, 0.59, 0.16, 0.35,
#                          0.09, 0.32,-0.12, 0.11,-0.21, 0.28,-0.24, 0.47,-0.11, 0.44,-0.17, 0.39,
#                          -0.01, 0.45,-0.18, 0.35,-0.27, 0.07,-0.12, 0.2 ,-0.24, 0.23, 0.01, 0.16,
#                          -0.23, 0.28,-0.13, 0.17,-0.26, 0.12,-0.11, 0.12,-0.23, 0.37,-0.2 , 0.24,
#                          -0.36, 0.19,-0.29, 0.22,-0.35, 0.28,-0.28, 0.2 ,-0.32, 0.15,-0.18, 0.16,
#                          -0.14, 0.35,-0.31, 0.23]])

#Cifar-10_40%MA:
all_w_data = np.array([[ 0.42, 1.23, 1.14, 1.12, 0.97, 1.33, 0.77, 0.99, 1.18, 0.78, 1.09, 0.69,
                         0.87, 1.07, 0.42, 0.67, 0.85, 0.64, 0.5 , 0.43, 0.54, 0.42, 0.41, 0.68,
                         0.82, 0.92, 0.24, 0.38, 0.5 , 0.61, 0.68, 0.38, 0.43, 0.63, 0.67, 0.78,
                         0.69, 0.65, 0.61, 0.49, 0.69, 0.4 , 0.34, 0.58, 0.46, 0.47, 0.52, 0.38,
                         0.53, 0.29, 0.63, 0.38, 0.49, 0.62, 0.6 , 0.61, 0.37, 0.72, 0.39, 0.41,
                         0.41, 0.68, 0.23, 0.51, 0.17, 0.52, 0.39, 0.29, 0.68, 0.28, 0.41, 0.61,
                         0.48, 0.59, 0.38, 0.6 , 0.45, 0.42, 0.47, 0.49, 0.35, 0.21, 0.57, 0.09,
                         0.42, 0.35, 0.58, 0.41, 0.35, 0.22, 0.58, 0.49, 0.38, 0.78, 0.42, 0.48,
                         0.34, 0.28, 0.18, 0.39],
                       [ 0.55, 0.98, 0.33, 0.51, 0.47, 0.4 ,-0.09, 0.49,-0.23,-0.11,-0.48,-0.29,
                         -0.47,-0.14,-0.46,-0.33,-0.35,-0.2 ,-0.65,-0.08,-0.73,-0.22,-0.61,-0.43,
                         -0.75,-0.13,-0.78, 0.09,-0.68,-0.11,-0.5 , 0.08,-0.72,-0.23,-0.66, 0.09,
                         -0.83,-0.01,-0.52, 0.07,-0.3 ,-0.41,-0.39,-0.29,-0.32,-0.02,-0.48, 0.07,
                         -0.54,-0.32,-0.68,-0.02,-0.49,-0.3 ,-0.33,-0.14,-0.56,-0.1 ,-0.59,-0.02,
                         -0.83,-0.06,-0.6 ,-0.23,-0.64,-0.22,-0.67,-0.24,-0.81,-0.17,-0.68,-0.14,
                         -0.78,-0.31,-0.82,-0.12,-0.7 ,-0.12,-0.62,-0.37,-0.57,-0.25,-0.64,-0.16,
                         -0.69,-0.12,-0.79,-0.09,-0.87,-0.04,-0.97,-0.39,-0.83,-0.18,-0.62,-0.12,
                         -0.71,-0.23,-0.63,-0.27],
                       [ 2.2 , 1.46, 2.06, 1.78, 2.33, 2.12, 2.33, 2.19, 2.23, 2.51, 2.67, 2.17,
                         2.45, 2.5 , 2.72, 2.48, 2.63, 2.38, 2.39, 2.52, 2.91, 2.57, 2.78, 2.79,
                         2.6 , 2.46, 2.54, 2.73, 2.99, 2.77, 2.39, 2.69, 2.7 , 2.67, 2.8 , 2.55,
                         2.73, 2.64, 2.81, 2.48, 2.7 , 2.79, 2.75, 2.57, 2.77, 2.72, 2.53, 2.59,
                         2.78, 2.52, 2.59, 2.71, 2.55, 2.69, 2.78, 2.87, 2.41, 2.7 , 2.45, 2.66,
                         2.6 , 2.65, 2.41, 2.83, 2.13, 2.39, 2.55, 2.48, 2.36, 2.46, 2.46, 2.58,
                         2.44, 2.52, 2.34, 2.56, 2.31, 2.67, 2.41, 2.46, 2.3 , 2.56, 2.44, 2.65,
                         2.19, 2.29, 2.29, 2.32, 2.04, 2.23, 1.93, 2.41, 2.03, 2.24, 1.83, 2.22,
                         1.97, 2.34, 1.95, 2.15],
                       [ 0.98, 0.65, 0.77, 0.63, 1.09, 0.96, 1.29, 0.92, 1.57, 1.25, 1.65, 1.56,
                         1.82, 1.93, 1.66, 1.93, 1.51, 1.7 , 1.33, 1.83, 1.38, 1.85, 1.41, 1.42,
                         1.37, 1.5 , 1.55, 1.47, 1.5 , 1.19, 1.46, 1.45, 1.49, 1.2 , 1.4 , 1.15,
                         1.31, 1.04, 1.17, 1.17, 1.06, 1.41, 1.32, 1.32, 1.28, 1.23, 1.31, 1.13,
                         1.41, 1.4 , 1.59, 1.21, 1.5 , 1.21, 1.4 , 1.14, 1.33, 0.98, 1.32, 1.19,
                         1.27, 1.24, 1.33, 1.27, 1.4 , 1.26, 1.08, 1.21, 1.4 , 1.18, 1.32, 1.25,
                         1.31, 1.37, 1.47, 1.27, 1.52, 1.34, 1.41, 1.36, 1.66, 1.36, 1.45, 1.28,
                         1.46, 1.15, 1.25, 1.02, 1.44, 1.3 , 1.66, 1.25, 1.45, 1.27, 1.58, 1.36,
                         1.44, 1.47, 1.51, 1.19],
                       [ 0.96, 0.92, 0.46, 1.19, 0.8 , 0.67, 1.  , 1.16, 1.08, 1.04, 1.  , 1.23,
                         1.18, 0.75, 1.12, 1.04, 0.75, 0.94, 0.96, 0.61, 0.78, 0.81, 1.07, 0.91,
                         0.64, 0.61, 0.76, 0.64, 0.6 , 0.61, 0.73, 0.86, 0.44, 0.71, 0.24, 0.47,
                         0.56, 0.68, 0.27, 0.68, 0.36, 0.56, 0.61, 0.3 , 0.39, 0.36, 0.33, 0.43,
                         0.24, 0.36, 0.3 , 0.24, 0.46, 0.55, 0.38, 0.3 , 0.59, 0.38, 0.43, 0.39,
                         0.22, 0.32, 0.4 , 0.31, 0.33, 0.4 , 0.4 , 0.39, 0.04, 0.43, 0.16, 0.4 ,
                         0.41, 0.16, 0.21, 0.07, 0.1 ,-0.03, 0.11,-0.11, 0.18,-0.18,-0.06, 0.04,
                         0.21, 0.13, 0.07, 0.13, 0.24, 0.  , 0.09, 0.06, 0.32,-0.14, 0.03,-0.01,
                         0.22, 0.02, 0.22,-0.01],
                       [ 0.47, 0.45, 0.11,-0.01, 0.24, 0.12, 0.06, 0.07, 0.27, 0.55, 0.47, 0.83,
                         0.42, 0.8 , 0.54, 0.99, 0.85, 0.88, 0.89, 0.67, 0.62, 0.92, 0.69, 1.05,
                         0.81, 1.08, 0.88, 1.26, 0.85, 0.94, 0.93, 0.87, 0.88, 0.98, 0.94, 0.7 ,
                         0.64, 0.93, 0.53, 0.85, 0.56, 0.82, 0.59, 0.71, 0.42, 0.71, 0.43, 0.84,
                         0.52, 0.6 , 0.33, 0.75, 0.55, 0.76, 0.5 , 0.63, 0.55, 0.89, 0.37, 0.78,
                         0.38, 0.7 , 0.34, 0.59, 0.59, 0.58, 0.03, 0.54, 0.09, 0.61, 0.26, 0.41,
                         0.16, 0.58, 0.31, 0.54,-0.14, 0.45, 0.04, 0.57, 0.05, 0.53, 0.01, 0.53,
                         -0.13, 0.45,-0.03, 0.62, 0.21, 0.56, 0.01, 0.45,-0.06, 0.62,-0.05, 0.38,
                         -0.17, 0.34,-0.22, 0.54],
                       [-0.01,-0.23, 0.04,-0.16,-0.11,-0.1 ,-0.08,-0.18,-0.31,-0.23,-0.07,-0.22,
                        -0.04,-0.22,-0.02,-0.16, 0.19, 0.32, 0.47, 0.43,-0.02,-0.09, 0.29, 0.08,
                        0.07,-0.15, 0.3 ,-0.32,-0.29,-0.16,-0.14,-0.28, 0.07,-0.1 , 0.09,-0.  ,
                        0.01,-0.14,-0.16, 0.23, 0.03,-0.33,-0.1 ,-0.03,-0.03,-0.07, 0.12,-0.16,
                        -0.2 ,-0.15, 0.03,-0.21,-0.09,-0.22,-0.18,-0.31,-0.04,-0.33, 0.01,-0.54,
                        -0.03,-0.56,-0.32,-0.35,-0.31,-0.26,-0.06,-0.26, 0.06,-0.64,-0.01,-0.54,
                        -0.17,-0.65,-0.14,-0.42,-0.18,-0.5 ,-0.29,-0.61,-0.4 ,-0.48,-0.25,-0.77,
                        -0.1 ,-0.73,-0.26,-0.75,-0.28,-0.67,-0.23,-0.77,-0.31,-0.74,-0.38,-0.71,
                        -0.19,-0.47,-0.26,-0.77],
                       [-3.08,-3.31,-2.54,-2.62,-2.98,-2.9 ,-3.  ,-3.05,-3.31,-3.29,-3.35,-3.49,
                        -3.48,-3.66,-3.18,-3.53,-3.15,-3.52,-2.88,-3.47,-2.78,-3.28,-3.13,-3.52,
                        -2.87,-3.43,-3.24,-3.52,-3.1 ,-3.33,-3.11,-3.48,-2.92,-3.52,-3.13,-3.56,
                        -3.08,-3.45,-3.19,-3.64,-3.  ,-3.62,-3.04,-3.44,-2.91,-3.69,-2.97,-3.45,
                        -2.98,-3.43,-2.78,-3.34,-2.9 ,-3.37,-2.77,-3.29,-2.73,-3.29,-2.6 ,-3.28,
                        -2.64,-3.37,-2.33,-3.49,-2.49,-3.13,-2.64,-3.04,-2.37,-2.8 ,-2.45,-3.07,
                        -2.5 ,-2.86,-2.58,-3.06,-2.14,-2.89,-2.38,-2.83,-2.17,-2.54,-2.26,-2.54,
                        -2.11,-2.41,-1.97,-2.29,-2.02,-2.22,-1.91,-2.21,-1.79,-2.42,-1.64,-2.32,
                        -1.72,-2.42,-1.72,-2.04],
                       [-0.45,-0.37,-0.32,-0.53,-0.33,-0.54,-0.39,-0.45,-0.52,-0.42,-0.92,-0.78,
                        -0.92,-1.16,-1.06,-0.85,-1.22,-0.95,-1.19,-0.79,-0.88,-1.01,-1.01,-0.95,
                        -0.78,-0.92,-0.48,-0.83,-0.34,-0.69,-0.6 ,-0.46,-0.66,-0.62,-0.59,-0.43,
                        -0.45,-0.47,-0.27,-0.57,-0.54,-0.23,-0.45,-0.11,-0.48,-0.16,-0.36,-0.34,
                        -0.43,-0.18,-0.41,-0.17,-0.4 ,-0.16,-0.54,-0.13,-0.32,-0.26,-0.36,-0.15,
                        -0.02,-0.27,-0.06, 0.08, 0.08,-0.03, 0.14,-0.06,-0.1 ,-0.07,-0.09,-0.14,
                        -0.16,-0.04, 0.22, 0.  , 0.01, 0.12, 0.15, 0.26,-0.01, 0.37, 0.07, 0.29,
                        -0.07, 0.28, 0.04, 0.11, 0.03, 0.08, 0.19, 0.12,-0.03, 0.13, 0.2 , 0.19,
                        0.13, 0.21, 0.17, 0.39],
                       [ 0.49, 0.76, 0.45, 0.59, 0.03, 0.41, 0.56, 0.31, 0.49, 0.35, 0.32, 0.71,
                         0.53, 0.5 , 0.62, 0.11, 0.27, 0.12, 0.46, 0.14, 0.45, 0.28, 0.34, 0.2 ,
                         0.31, 0.26, 0.43, 0.3 , 0.15, 0.35, 0.3 , 0.03, 0.42, 0.39, 0.33, 0.35,
                         0.49, 0.22, 0.81, 0.31, 0.47, 0.65, 0.39, 0.4 , 0.41, 0.45, 0.53, 0.46,
                         0.6 , 0.86, 0.32, 0.39, 0.23, 0.12, 0.04, 0.2 , 0.26, 0.18, 0.44, 0.41,
                         0.44, 0.48, 0.41, 0.28, 0.51, 0.27, 0.54, 0.45, 0.39, 0.47, 0.34, 0.36,
                         0.52, 0.34, 0.3 , 0.24, 0.44, 0.2 , 0.34, 0.42, 0.25, 0.06, 0.27, 0.2 ,
                         0.41, 0.2 , 0.42, 0.1 , 0.43, 0.1 , 0.2 , 0.14, 0.37,-0.03, 0.14, 0.05,
                         0.17,-0.06, 0.27,-0.1 ]])



#MNIST20MA
# all_w_data = np.array([[ 0.52, 0.53, 0.48, 0.49, 0.36, 0.33, 0.18, 0.17, 0.04, 0.02,-0.05,-0.04,
#    -0.13,-0.09,-0.17,-0.13,-0.18,-0.17,-0.21,-0.18,-0.21,-0.22,-0.25,-0.21,
#    -0.26,-0.23,-0.25,-0.25,-0.27,-0.26,-0.28,-0.26,-0.29,-0.27,-0.3 ,-0.29,
#    -0.31,-0.28,-0.32,-0.28,-0.31,-0.3 ,-0.3 ,-0.32,-0.32,-0.32,-0.35,-0.33,
#    -0.35,-0.33,-0.36,-0.34,-0.35,-0.34,-0.33,-0.35,-0.32,-0.33,-0.35,-0.34,
#    -0.34,-0.37,-0.36,-0.36,-0.37,-0.39,-0.35,-0.39,-0.37,-0.4 ,-0.36,-0.41,
#    -0.36,-0.4 ,-0.36,-0.4 ,-0.37,-0.4 ,-0.38,-0.39,-0.37,-0.4 ,-0.38,-0.4 ,
#    -0.38,-0.41,-0.39,-0.41,-0.39,-0.41,-0.4 ,-0.44,-0.39,-0.43,-0.41,-0.44,
#    -0.42,-0.43,-0.42,-0.45],
#  [-0.38,-0.39,-0.25,-0.28,-0.17,-0.19,-0.12,-0.17,-0.08,-0.1 ,-0.05,-0.1 ,
#   -0.01,-0.04, 0.03,-0.03, 0.07, 0.04, 0.11, 0.09, 0.13, 0.12, 0.16, 0.14,
#   0.22, 0.19, 0.25, 0.19, 0.27, 0.24, 0.31, 0.23, 0.32, 0.26, 0.33, 0.26,
#   0.35, 0.3 , 0.38, 0.3 , 0.37, 0.31, 0.39, 0.33, 0.39, 0.32, 0.41, 0.35,
#   0.41, 0.34, 0.42, 0.35, 0.42, 0.38, 0.41, 0.39, 0.4 , 0.4 , 0.43, 0.36,
#   0.43, 0.4 , 0.43, 0.42, 0.44, 0.42, 0.45, 0.43, 0.45, 0.42, 0.45, 0.43,
#   0.47, 0.42, 0.45, 0.42, 0.48, 0.41, 0.45, 0.41, 0.46, 0.41, 0.44, 0.41,
#   0.47, 0.4 , 0.45, 0.44, 0.46, 0.42, 0.47, 0.45, 0.47, 0.39, 0.5 , 0.46,
#   0.48, 0.43, 0.48, 0.45],
#  [-0.74,-0.74,-0.67,-0.68,-0.47,-0.48,-0.33,-0.33,-0.25,-0.27,-0.24,-0.23,
#   -0.19,-0.2 ,-0.17,-0.17,-0.17,-0.15,-0.13,-0.15,-0.14,-0.13,-0.15,-0.13,
#   -0.13,-0.1 ,-0.13,-0.11,-0.13,-0.1 ,-0.14,-0.12,-0.15,-0.13,-0.14,-0.14,
#   -0.17,-0.13,-0.14,-0.12,-0.18,-0.13,-0.2 ,-0.14,-0.18,-0.13,-0.19,-0.16,
#   -0.19,-0.16,-0.2 ,-0.14,-0.19,-0.14,-0.19,-0.16,-0.2 ,-0.16,-0.21,-0.17,
#   -0.22,-0.18,-0.23,-0.21,-0.25,-0.2 ,-0.26,-0.24,-0.27,-0.24,-0.28,-0.25,
#   -0.28,-0.24,-0.28,-0.25,-0.28,-0.25,-0.29,-0.24,-0.3 ,-0.26,-0.31,-0.28,
#   -0.32,-0.27,-0.33,-0.28,-0.35,-0.3 ,-0.36,-0.3 ,-0.35,-0.29,-0.36,-0.32,
#   -0.37,-0.33,-0.37,-0.33],
#  [-0.05,-0.05, 0.05, 0.08, 0.06, 0.08,-0.01, 0.07,-0.04, 0.03,-0.05, 0.01,
#   -0.05,-0.02,-0.06,-0.04,-0.1 ,-0.04,-0.09,-0.04,-0.08,-0.06,-0.08,-0.08,
#   -0.11,-0.1 ,-0.12,-0.08,-0.12,-0.09,-0.13,-0.09,-0.1 ,-0.1 ,-0.12,-0.1 ,
#   -0.11,-0.09,-0.14,-0.09,-0.14,-0.09,-0.13,-0.08,-0.13,-0.09,-0.14,-0.09,
#   -0.14,-0.09,-0.14,-0.1 ,-0.12,-0.1 ,-0.13,-0.08,-0.13,-0.07,-0.12,-0.09,
#   -0.12,-0.07,-0.12,-0.06,-0.12,-0.06,-0.09,-0.05,-0.1 ,-0.06,-0.1 ,-0.05,
#   -0.09,-0.04,-0.08,-0.05,-0.09,-0.05,-0.09,-0.05,-0.09,-0.04,-0.09,-0.06,
#   -0.07,-0.03,-0.07,-0.04,-0.05,-0.05,-0.07,-0.02,-0.07,-0.04,-0.09,-0.03,
#   -0.06,-0.02,-0.05,-0.02],
#  [-0.35,-0.35,-0.33,-0.33,-0.32,-0.34,-0.29,-0.31,-0.27,-0.28,-0.2 ,-0.24,
#   -0.18,-0.2 ,-0.15,-0.18,-0.13,-0.16,-0.13,-0.13,-0.1 ,-0.15,-0.1 ,-0.1 ,
#   -0.07,-0.1 ,-0.05,-0.1 ,-0.05,-0.1 ,-0.05,-0.11,-0.02,-0.11,-0.05,-0.09,
#   -0.02,-0.08,-0.04,-0.08,-0.01,-0.07, 0.  ,-0.06, 0.01,-0.05, 0.02,-0.03,
#   0.04,-0.04, 0.03,-0.03, 0.03,-0.03, 0.03,-0.03, 0.05,-0.03, 0.05,-0.02,
#   0.06,-0.04, 0.07,-0.03, 0.09,-0.01, 0.07, 0.01, 0.08, 0.01, 0.08, 0.03,
#   0.09, 0.03, 0.11, 0.03, 0.11, 0.04, 0.11, 0.06, 0.13, 0.06, 0.13, 0.07,
#   0.12, 0.07, 0.12, 0.08, 0.15, 0.07, 0.14, 0.1 , 0.15, 0.11, 0.15, 0.12,
#   0.16, 0.11, 0.16, 0.11],
#  [-0.29,-0.29,-0.31,-0.29,-0.14,-0.1 , 0.04, 0.05, 0.13, 0.13, 0.19, 0.22,
#   0.21, 0.23, 0.24, 0.24, 0.24, 0.27, 0.23, 0.24, 0.19, 0.22, 0.19, 0.2 ,
#   0.16, 0.2 , 0.12, 0.2 , 0.11, 0.16, 0.09, 0.13, 0.08, 0.16, 0.08, 0.13,
#   0.04, 0.11, 0.02, 0.09, 0.01, 0.08,-0.  , 0.06,-0.02, 0.04,-0.03, 0.04,
#   -0.02, 0.03,-0.04,-0.  ,-0.05,-0.03,-0.05,-0.03,-0.07,-0.03,-0.07,-0.02,
#   -0.07,-0.  ,-0.09,-0.02,-0.08,-0.01,-0.07,-0.  ,-0.09,-0.01,-0.09,-0.04,
#   -0.07,-0.02,-0.08,-0.02,-0.09,-0.03,-0.09,-0.02,-0.09,-0.  ,-0.09,-0.02,
#   -0.12,-0.03,-0.11,-0.04,-0.11,-0.04,-0.1 ,-0.05,-0.12,-0.02,-0.1 ,-0.03,
#   -0.13,-0.04,-0.13,-0.03],
#  [ 0.48, 0.48, 0.43, 0.43, 0.27, 0.3 , 0.18, 0.16, 0.09, 0.1 , 0.04, 0.04,
#    -0.  ,-0.  ,-0.05,-0.04,-0.08,-0.08,-0.09,-0.12,-0.13,-0.13,-0.13,-0.15,
#    -0.15,-0.17,-0.16,-0.18,-0.15,-0.18,-0.17,-0.18,-0.19,-0.2 ,-0.18,-0.2 ,
#    -0.2 ,-0.2 ,-0.17,-0.21,-0.17,-0.22,-0.18,-0.21,-0.18,-0.18,-0.19,-0.21,
#    -0.19,-0.2 ,-0.18,-0.22,-0.16,-0.22,-0.17,-0.24,-0.19,-0.22,-0.19,-0.22,
#    -0.2 ,-0.22,-0.19,-0.23,-0.19,-0.25,-0.19,-0.25,-0.18,-0.27,-0.2 ,-0.23,
#    -0.22,-0.26,-0.22,-0.27,-0.21,-0.26,-0.21,-0.28,-0.22,-0.28,-0.23,-0.25,
#    -0.22,-0.28,-0.21,-0.28,-0.21,-0.27,-0.21,-0.27,-0.21,-0.29,-0.21,-0.29,
#    -0.21,-0.28,-0.22,-0.3 ],
#  [-0.03,-0.04,-0.2 ,-0.2 ,-0.4 ,-0.39,-0.56,-0.54,-0.62,-0.64,-0.69,-0.68,
#   -0.74,-0.73,-0.78,-0.74,-0.78,-0.78,-0.82,-0.79,-0.84,-0.77,-0.81,-0.8 ,
#   -0.82,-0.8 ,-0.81,-0.79,-0.8 ,-0.78,-0.8 ,-0.75,-0.8 ,-0.76,-0.78,-0.73,
#   -0.79,-0.76,-0.79,-0.75,-0.78,-0.74,-0.79,-0.74,-0.78,-0.73,-0.75,-0.74,
#   -0.76,-0.73,-0.76,-0.74,-0.78,-0.73,-0.77,-0.72,-0.77,-0.76,-0.76,-0.72,
#   -0.77,-0.72,-0.76,-0.73,-0.77,-0.72,-0.78,-0.71,-0.77,-0.7 ,-0.74,-0.7 ,
#   -0.78,-0.7 ,-0.74,-0.7 ,-0.77,-0.7 ,-0.74,-0.72,-0.77,-0.71,-0.75,-0.71,
#   -0.76,-0.72,-0.76,-0.72,-0.76,-0.7 ,-0.75,-0.73,-0.76,-0.68,-0.76,-0.73,
#   -0.73,-0.7 ,-0.75,-0.71],
#  [ 0.38, 0.38, 0.31, 0.29, 0.27, 0.24, 0.32, 0.32, 0.38, 0.36, 0.4 , 0.38,
#    0.43, 0.41, 0.44, 0.43, 0.46, 0.46, 0.48, 0.49, 0.53, 0.5 , 0.54, 0.53,
#    0.53, 0.52, 0.55, 0.55, 0.55, 0.56, 0.57, 0.58, 0.58, 0.6 , 0.6 , 0.61,
#    0.63, 0.61, 0.62, 0.64, 0.66, 0.66, 0.65, 0.68, 0.67, 0.67, 0.7 , 0.7 ,
#    0.7 , 0.71, 0.72, 0.73, 0.7 , 0.72, 0.7 , 0.74, 0.72, 0.76, 0.73, 0.75,
#    0.72, 0.76, 0.75, 0.78, 0.77, 0.77, 0.77, 0.78, 0.78, 0.8 , 0.8 , 0.8 ,
#    0.8 , 0.8 , 0.79, 0.81, 0.78, 0.83, 0.8 , 0.82, 0.81, 0.83, 0.84, 0.86,
#    0.82, 0.87, 0.84, 0.85, 0.83, 0.86, 0.82, 0.87, 0.84, 0.85, 0.84, 0.86,
#    0.85, 0.87, 0.86, 0.9 ],
#  [-0.12,-0.11,-0.08,-0.09,-0.04,-0.02, 0.02, 0.01, 0.05, 0.06, 0.07, 0.08,
#   0.09, 0.08, 0.1 , 0.08, 0.11, 0.05, 0.08, 0.03, 0.08, 0.05, 0.08, 0.04,
#   0.06, 0.02, 0.04, 0.01, 0.03,-0.  , 0.03,-0.  , 0.02,-0.02, 0.01,-0.02,
#   0.  ,-0.04, 0.01,-0.05, 0.  ,-0.06,-0.01,-0.07,-0.02,-0.08,-0.05,-0.09,
#   -0.05,-0.09,-0.04,-0.08,-0.06,-0.08,-0.05,-0.09,-0.05,-0.09,-0.06,-0.09,
#   -0.07,-0.11,-0.07,-0.11,-0.09,-0.12,-0.09,-0.12,-0.09,-0.11,-0.11,-0.13,
#   -0.1 ,-0.14,-0.12,-0.13,-0.11,-0.13,-0.11,-0.15,-0.11,-0.16,-0.1 ,-0.16,
#   -0.1 ,-0.15,-0.11,-0.15,-0.12,-0.14,-0.1 ,-0.15,-0.1 ,-0.14,-0.11,-0.15,
#   -0.12,-0.16,-0.11,-0.16]])

#MNIST_40MA
# all_w_data = np.array([[ 0.51, 0.51, 0.47, 0.49, 0.35, 0.36, 0.17, 0.17, 0.03, 0.04,-0.05,-0.04,
#    -0.13,-0.11,-0.16,-0.15,-0.19,-0.16,-0.23,-0.19,-0.25,-0.19,-0.26,-0.21,
#    -0.29,-0.23,-0.3 ,-0.23,-0.33,-0.24,-0.31,-0.25,-0.34,-0.26,-0.36,-0.27,
#    -0.36,-0.28,-0.38,-0.29,-0.35,-0.31,-0.37,-0.31,-0.38,-0.31,-0.38,-0.34,
#    -0.39,-0.31,-0.38,-0.33,-0.4 ,-0.33,-0.42,-0.33,-0.41,-0.35,-0.41,-0.36,
#    -0.4 ,-0.37,-0.42,-0.36,-0.43,-0.37,-0.43,-0.37,-0.43,-0.37,-0.44,-0.36,
#    -0.44,-0.37,-0.45,-0.37,-0.47,-0.38,-0.47,-0.38,-0.48,-0.38,-0.47,-0.38,
#    -0.47,-0.4 ,-0.49,-0.42,-0.48,-0.41,-0.48,-0.42,-0.5 ,-0.42,-0.5 ,-0.43,
#    -0.51,-0.44,-0.51,-0.43],
#  [-0.26,-0.27,-0.08,-0.09, 0.02, 0.  , 0.08, 0.08, 0.15, 0.13, 0.18, 0.19,
#   0.24, 0.25, 0.29, 0.29, 0.37, 0.35, 0.39, 0.39, 0.43, 0.43, 0.49, 0.48,
#   0.52, 0.52, 0.55, 0.53, 0.58, 0.6 , 0.58, 0.58, 0.6 , 0.65, 0.61, 0.61,
#   0.65, 0.68, 0.63, 0.63, 0.67, 0.72, 0.67, 0.64, 0.71, 0.75, 0.66, 0.62,
#   0.72, 0.78, 0.65, 0.62, 0.73, 0.86, 0.63, 0.54, 0.77, 0.92, 0.58, 0.53,
#   0.81, 0.97, 0.52, 0.54, 0.87, 0.97, 0.48, 0.58, 0.88, 0.98, 0.44, 0.57,
#   0.9 , 1.02, 0.48, 0.56, 0.94, 1.03, 0.47, 0.6 , 0.92, 1.05, 0.53, 0.58,
#   0.93, 1.06, 0.52, 0.62, 0.96, 1.05, 0.5 , 0.64, 0.95, 1.07, 0.5 , 0.64,
#   0.95, 1.09, 0.51, 0.63],
#  [-0.74,-0.74,-0.69,-0.68,-0.48,-0.5 ,-0.36,-0.38,-0.28,-0.32,-0.26,-0.29,
#   -0.23,-0.26,-0.23,-0.24,-0.21,-0.21,-0.19,-0.2 ,-0.18,-0.21,-0.18,-0.2 ,
#   -0.17,-0.18,-0.17,-0.18,-0.18,-0.19,-0.17,-0.2 ,-0.18,-0.18,-0.18,-0.18,
#   -0.17,-0.18,-0.18,-0.19,-0.19,-0.19,-0.2 ,-0.2 ,-0.19,-0.21,-0.18,-0.21,
#   -0.2 ,-0.21,-0.2 ,-0.21,-0.18,-0.2 ,-0.19,-0.21,-0.17,-0.21,-0.18,-0.22,
#   -0.19,-0.19,-0.21,-0.24,-0.19,-0.22,-0.23,-0.24,-0.21,-0.24,-0.23,-0.24,
#   -0.22,-0.23,-0.24,-0.24,-0.23,-0.23,-0.23,-0.26,-0.22,-0.24,-0.24,-0.27,
#   -0.25,-0.25,-0.25,-0.26,-0.25,-0.26,-0.27,-0.27,-0.24,-0.25,-0.26,-0.28,
#   -0.25,-0.26,-0.26,-0.29],
#  [-0.04,-0.04, 0.07, 0.08, 0.08, 0.1 , 0.06, 0.07, 0.01, 0.03,-0.03,-0.  ,
#   -0.04,-0.04,-0.05,-0.06,-0.1 ,-0.08,-0.09,-0.09,-0.12,-0.1 ,-0.11,-0.11,
#   -0.14,-0.12,-0.14,-0.12,-0.14,-0.14,-0.12,-0.13,-0.13,-0.12,-0.13,-0.12,
#   -0.14,-0.13,-0.14,-0.14,-0.14,-0.15,-0.14,-0.15,-0.13,-0.16,-0.15,-0.14,
#   -0.14,-0.14,-0.15,-0.14,-0.13,-0.14,-0.13,-0.13,-0.15,-0.15,-0.14,-0.15,
#   -0.14,-0.13,-0.13,-0.13,-0.14,-0.18,-0.14,-0.16,-0.13,-0.15,-0.15,-0.15,
#   -0.14,-0.15,-0.14,-0.13,-0.13,-0.15,-0.16,-0.14,-0.15,-0.16,-0.15,-0.16,
#   -0.14,-0.15,-0.14,-0.16,-0.16,-0.16,-0.15,-0.17,-0.15,-0.19,-0.14,-0.18,
#   -0.15,-0.17,-0.14,-0.17],
#  [-0.36,-0.36,-0.31,-0.32,-0.33,-0.33,-0.32,-0.33,-0.3 ,-0.29,-0.26,-0.26,
#   -0.24,-0.22,-0.2 ,-0.21,-0.16,-0.17,-0.12,-0.16,-0.09,-0.13,-0.09,-0.11,
#   -0.08,-0.08,-0.06,-0.09,-0.05,-0.05,-0.05,-0.07,-0.03,-0.07,-0.03,-0.04,
#   -0.  ,-0.04, 0.01,-0.03, 0.  ,-0.01, 0.01, 0.01, 0.03, 0.02, 0.03, 0.04,
#   0.06, 0.05, 0.06, 0.04, 0.08, 0.06, 0.08, 0.05, 0.1 , 0.07, 0.1 , 0.06,
#   0.1 , 0.08, 0.12, 0.09, 0.11, 0.11, 0.14, 0.11, 0.14, 0.12, 0.15, 0.12,
#   0.15, 0.13, 0.15, 0.14, 0.15, 0.15, 0.16, 0.15, 0.17, 0.18, 0.18, 0.18,
#   0.2 , 0.19, 0.2 , 0.2 , 0.21, 0.21, 0.24, 0.2 , 0.25, 0.22, 0.24, 0.23,
#   0.24, 0.25, 0.26, 0.25],
#  [-0.28,-0.28,-0.29,-0.29,-0.13,-0.13, 0.04, 0.02, 0.14, 0.11, 0.19, 0.19,
#   0.25, 0.24, 0.24, 0.23, 0.23, 0.23, 0.2 , 0.22, 0.2 , 0.2 , 0.18, 0.17,
#   0.14, 0.13, 0.13, 0.12, 0.12, 0.09, 0.08, 0.09, 0.07, 0.07, 0.07, 0.05,
#   0.04, 0.02, 0.03, 0.02, 0.02,-0.01, 0.  ,-0.01,-0.02,-0.03,-0.02,-0.06,
#   -0.02,-0.07,-0.02,-0.07,-0.04,-0.09,-0.05,-0.09,-0.05,-0.09,-0.06,-0.11,
#   -0.08,-0.12,-0.09,-0.12,-0.09,-0.13,-0.11,-0.14,-0.09,-0.15,-0.09,-0.16,
#   -0.09,-0.14,-0.1 ,-0.16,-0.1 ,-0.18,-0.11,-0.18,-0.11,-0.17,-0.13,-0.18,
#   -0.14,-0.19,-0.14,-0.19,-0.14,-0.18,-0.13,-0.21,-0.14,-0.2 ,-0.15,-0.2 ,
#   -0.15,-0.21,-0.15,-0.21],
#  [ 0.49, 0.51, 0.45, 0.47, 0.3 , 0.33, 0.17, 0.22, 0.1 , 0.16, 0.04, 0.11,
#    -0.  , 0.03,-0.03, 0.01,-0.07,-0.01,-0.08,-0.05,-0.1 ,-0.07,-0.13,-0.09,
#    -0.12,-0.1 ,-0.13,-0.13,-0.14,-0.13,-0.13,-0.12,-0.14,-0.12,-0.14,-0.12,
#    -0.15,-0.11,-0.15,-0.12,-0.16,-0.12,-0.16,-0.13,-0.18,-0.11,-0.17,-0.13,
#    -0.17,-0.13,-0.17,-0.15,-0.19,-0.14,-0.17,-0.14,-0.18,-0.13,-0.18,-0.14,
#    -0.19,-0.15,-0.19,-0.16,-0.2 ,-0.17,-0.2 ,-0.14,-0.21,-0.14,-0.21,-0.17,
#    -0.22,-0.17,-0.22,-0.2 ,-0.22,-0.18,-0.23,-0.18,-0.23,-0.19,-0.22,-0.17,
#    -0.23,-0.19,-0.24,-0.19,-0.25,-0.2 ,-0.25,-0.19,-0.25,-0.21,-0.24,-0.19,
#    -0.25,-0.2 ,-0.24,-0.21],
#  [-0.18,-0.19,-0.44,-0.43,-0.62,-0.62,-0.77,-0.76,-0.85,-0.84,-0.89,-0.91,
#   -0.95,-0.95,-0.99,-0.98,-0.99,-1.02,-1.01,-1.03,-1.03,-1.04,-1.02,-1.04,
#   -1.03,-1.07,-1.04,-1.03,-1.03,-1.07,-1.05,-1.02,-1.04,-1.08,-1.06,-1.04,
#   -1.06,-1.08,-1.02,-1.02,-1.05,-1.11,-1.01,-1.  ,-1.07,-1.11,-1.01,-0.97,
#   -1.06,-1.15,-1.01,-0.94,-1.09,-1.21,-0.97,-0.86,-1.14,-1.26,-0.91,-0.81,
#   -1.18,-1.26,-0.84,-0.79,-1.2 ,-1.23,-0.78,-0.83,-1.23,-1.26,-0.74,-0.8 ,
#   -1.2 ,-1.27,-0.75,-0.78,-1.21,-1.27,-0.71,-0.8 ,-1.18,-1.29,-0.74,-0.76,
#   -1.17,-1.28,-0.74,-0.79,-1.21,-1.23,-0.72,-0.81,-1.21,-1.26,-0.72,-0.8 ,
#   -1.19,-1.27,-0.72,-0.79],
#  [ 0.4 , 0.39, 0.33, 0.31, 0.26, 0.24, 0.32, 0.31, 0.36, 0.34, 0.38, 0.34,
#    0.4 , 0.38, 0.45, 0.44, 0.46, 0.43, 0.49, 0.46, 0.5 , 0.47, 0.52, 0.51,
#    0.55, 0.51, 0.57, 0.52, 0.58, 0.55, 0.59, 0.56, 0.63, 0.56, 0.62, 0.57,
#    0.64, 0.59, 0.64, 0.61, 0.63, 0.63, 0.66, 0.64, 0.68, 0.63, 0.69, 0.67,
#    0.68, 0.67, 0.68, 0.67, 0.7 , 0.68, 0.71, 0.69, 0.71, 0.69, 0.72, 0.71,
#    0.74, 0.7 , 0.72, 0.73, 0.74, 0.74, 0.74, 0.72, 0.75, 0.73, 0.74, 0.73,
#    0.75, 0.73, 0.76, 0.75, 0.76, 0.74, 0.77, 0.75, 0.78, 0.76, 0.76, 0.75,
#    0.78, 0.77, 0.78, 0.76, 0.8 , 0.77, 0.78, 0.79, 0.79, 0.79, 0.8 , 0.79,
#    0.81, 0.79, 0.78, 0.8 ],
#  [-0.12,-0.11,-0.09,-0.11,-0.01,-0.03, 0.04, 0.04, 0.08, 0.07, 0.13, 0.11,
#   0.14, 0.1 , 0.12, 0.11, 0.1 , 0.07, 0.08, 0.08, 0.06, 0.06, 0.03, 0.04,
#   0.04, 0.04, 0.04, 0.03, 0.03, 0.02, 0.01,-0.  ,-0.01,-0.01, 0.03,-0.03,
#   0.  ,-0.02,-0.  ,-0.02, 0.  ,-0.03,-0.01,-0.04,-0.01,-0.04,-0.03,-0.04,
#   -0.03,-0.04,-0.03,-0.04,-0.03,-0.06,-0.04,-0.06,-0.02,-0.06,-0.06,-0.06,
#   -0.03,-0.07,-0.05,-0.09,-0.04,-0.08,-0.03,-0.08,-0.02,-0.08,-0.02,-0.09,
#   -0.04,-0.11,-0.04,-0.11,-0.04,-0.1 ,-0.06,-0.1 ,-0.05,-0.11,-0.06,-0.14,
#   -0.06,-0.12,-0.05,-0.12,-0.03,-0.13,-0.06,-0.12,-0.05,-0.1 ,-0.06,-0.13,
#   -0.04,-0.13,-0.06,-0.14]])

# 生成测试数据
epochs = all_w_data.shape[1]  # 假设数据有 100 个 epoch
averaged_w_data = np.mean(all_w_data.reshape(all_w_data.shape[0], -1, 10), axis=2)
new_epochs = np.arange(10, epochs + 1, 10)

# 绘图
plt.figure(figsize=(12, 8))

# 绘制所有类别的曲线，并将 Class 1 和 Class 9 区别出来
# 绘制所有类别的曲线，并将 Class 7 和 Class 2 用红色（Class 4）和蓝色（Class 0）表示为实线
for class_id in range(all_w_data.shape[0]):
    if class_id == 7:  # 用红色实线表示 Class 7
        plt.plot(new_epochs, averaged_w_data[class_id], label=f'Class {class_id}', color='#d62728', lw=2.5, linestyle='-', marker='o')
    elif class_id == 2:  # 用蓝色实线表示 Class 2
        plt.plot(new_epochs, averaged_w_data[class_id], label=f'Class {class_id}', color='#1f77b4', lw=2.5, linestyle='-', marker='o')
    #elif class_id == 1:  # 目标类别 Class 1
    #     plt.plot(new_epochs, averaged_w_data[class_id], label=f'Class {class_id}', color='orange', lw=2.5, marker='o')
    # elif class_id == 9:  # 被攻击的类别 Class 9
    #     plt.plot(new_epochs, averaged_w_data[class_id], label=f'Class {class_id}', color='cyan', lw=2.5, marker='o')
    else:
        plt.plot(new_epochs, averaged_w_data[class_id], label=f'Class {class_id}', linestyle='--', marker='o', alpha=0.6)

colors = plt.rcParams['axes.prop_cycle'].by_key()['color']
print(f'Default colors: {colors}')
#Default colors: ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf']


# 添加标题、坐标轴标签和图例
plt.title('10 classes via LFA', fontsize=16)
plt.xlabel('Epochs', fontsize=14)
plt.ylabel('Average W', fontsize=14)
plt.legend(loc='upper right', fontsize=12)
plt.grid(True)

# 显示图形
plt.show()
# epochs = all_w_data.shape[1]
# averaged_w_data = np.mean(all_w_data.reshape(all_w_data.shape[0], -1, 10), axis=2)
#
# # 生成新的 epoch 轴，每 10 个 epoch 标记一次
# new_epochs = np.arange(10, epochs + 1, 10)
#
# # 绘图
# plt.figure(figsize=(12, 8))
#
# for class_id in range(all_w_data.shape[0]):  # 遍历 10 个类别
#     plt.plot(new_epochs, averaged_w_data[class_id], label=f'Class {class_id}', marker='o')
#
# # 添加标题、坐标轴标签和图例
# plt.title('10 个类别在不同 Epoch 下的 W 值变化趋势 (每 10 个 Epoch 取均值)', fontsize=16)
# plt.xlabel('Epochs', fontsize=14)
# plt.ylabel('平均 W 值', fontsize=14)
# plt.legend(loc='upper right', fontsize=12)
# plt.grid(True)
#
# # 显示图形
# plt.show()